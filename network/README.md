# Network
-----

### 1000BASE-T

LANケーブルを挿すところの規格の1つ。
他にも何種類かある。
|規格名|伝送速度||
|---|---|---|
|1000BASE-T|1000Mbps|1ペア250M×4ペア cat5e以上のUTPケーブル|
|1000BASE-TX|1000Mbps|1ペア500M×2ペア cat6以上のUTPケーブル|


### ACL：Access Control List

通信アクセスを制御するためのリスト。
ルータの通過を許可するパケット、拒否するパケットを指定する機能。
標準ではIPアドレスでフィルタリングを行うが、拡張すればポート番号、プロトコル番号でのフィルタリングも可能。


### ARP：Address Resolution Protocol

あーぷと読む。
IPアドレスからMACアドレスの情報を得られるプロトコル。
宛先MACアドレスがわからない時、送信元はARPリクエストをブロードキャストで送信する。
このリクエストに対象のマシンがARPリプライを返す。
これにより送信元はMACアドレスを入手し、イーサネットフレームを作成できるようになる。


### BGP：Border Gateway Protocol

複数の独立したネットワークを接続したTCP/IPネットワークにおいて、ネットワーク間の経路情報を通信機器間で交換する手順を定めたプロトコルのひとつ。
インターネットのような大規模なTCP/IPネットワークは、各組織が運用するネットワークである自律システム（AS：Autonomous System）を構成単位とし、これを相互に接続した形態となっている。


### CIDR：Classless Inter-Domain Routing

サイダー。192.168.12.1/24 などの表記方法。
クラスを使わないUPアドレスの割り当てを行う技術。
クラスとはIPアドレスのネットワーク部とホスト部を決められられたブロック単位で区切る方法で、
クラスを使用するとアドレス空間の利用に無駄が生じてしまうが、クラスを使用しないCIDRでは任意のブロック単位で区切るので、アドレス空間を効率的に利用することができる。

### CORS: Cross-Origin Resource Sharing
クライアント（ブラウザ）とサーバが異なるオリジン（ドメイン、プロトコル、ポート番号）にアクセスするとき、リジン間 HTTP リクエストによって許可できる仕組み。
現代の主要なブラウザは全て、同一生成元ポリシーに基づく制限を実装している。

GET、POST、HEAD を使い、かつ Accept、 Accept-Language、Content-Type などのいくつか基本的な HTTP ヘッダーがセットされただけのリクエストであれば、この HTTP リクエストは 「単純な HTTP リクエスト」(simple Cross-Origin request) 。単純なリクエストはクロスオリジンでもサーバに送信される。

単純リクエスト以外の場合、事前に問い合わせてアクセスが許可されるか確認する。これがプリフライトリクエスト。クロスドメインのリクエストを許可する場合は、Access-Control-Allow-Origin (ACAO) HTTP ヘッダーをセットして、応答しなければならない。


### FCoE：Fibre Channel over Ethernet

SANとLANをイーサネットで統合することを目的に考え出されたプロトコル。
FC（ファイバチャネル）フレームをイーサネットのフレームでカプセル化することで、
イーサネット上で伝送ができる。


### FTP：File Transfer Protocol

「制御用」と「データ転送用」の2つのTCPコネクションを確立してファイル転送を行う。
#### 制御用（21/TCP）
GETやPUTのコマンド送信と、その応答をやり取りするためのコネクション。
データ転送中でも制御コマンドを実行することができる。
FTPクライアントが終了するまで処理が継続される。

#### データ転送用（20/TCP）
データの転送処理が発生するたびに確立される。


### ICMP：Internet Control Message Protocol

TCP/IPの補助的な役割を果たすプロトコル。 
IPの「エラー通知」や「制御メッセージ」を転送するためのプロトコル。


### IEEE802.11（無線LAN規格）
あい・とりぷるいー・はちまるにーてんいちいちと読む。
無線LANの国際的な標準規格のこと。
点以降の規格がいくつか分類される。多いので割愛。

|周波数帯|特徴|
|---|---|
|2.4GHz|波長が長いので障害物に強く、離れた部屋でも届きやすい。同じ周波数を利用する機器が多いので、干渉により不安定になる。|
|5GHz|無線LAN専用の周波数なので干渉を受けにくく、安定しやすい。壁や天井などの障害物に弱く、2.4GHzより通信距離が短い。|
|60GHz|あまり利用されない周波数のため、干渉をさらに受けにくい。通信距離わずか10ｍなので、別室や屋外利用に向かない。|


### IPアドレス
クラスA〜Cまで存在。
ネットワーク部とホスト部に振り分ける桁数の違い。
あたりまえだけどホスト部が少ないほど、割り当てれられるのが少なくなるので小規模。
先頭ビットがクラスDとEで予約されているのは使えない。

||クラスA|クラスB|クラスC|
|---|---|---|---|
|ネットワーク規模|大規模|中規模向け|小規模向け|
|ネットワーク部|/8|/16|/24|
|ホスト部|下位24ビット|下位16ビット|下位8ビット|
|グローバルアドレス|1.0.0.0 ～ 126.0.0.0|128.1.0.0 ～ 191.254.0.0|192.0.0.0 ～ 223.255.255.0|
|プライベートアドレス|10.0.0.1 ～ 126.255.255.254|128.0.0.1 ～ 191.254.255.254|192.168.0.1 ～ 192.168.255.254|

#### クラスD
224.0.0.0 〜 239.255.255.255

最初の4ビットが「1110」であることが決められている。
マルチキャスト通信は、音声や映像データの一斉送信などのマルチメディアアプリケーションが使用する。

#### クラスE
240.0.0.0 〜 255.255.255.255

最初の4ビットが「1111」であることが決められている。
実験用として、TCP/IP（IPV4）の開発当初から予約されており、実際に使われることはない。
 
#### サブネットマスク
クラスの概念が導入されると、規模が大きすぎず小さすぎずのクラスBの利用が集中。
そしてそのクラスのIPアドレスが不足するものの、ホストは65､534まで設定ができるので
ネットワーク上でのIPアドレスは余ってしまう。
そこでサブネットマスクが登場し、クラスに縛られることなくネットワーク部とホスト部が分けられるようになった。
ネットワーク部は1、ホスト部は0で表現される。
CIDR表記は書き方が違うだけでできることは一緒。


### IPsec：IP Security Architecture

 暗号化技術を使ってIPパケットの完全性、気密性を実現する仕組みのこと。
 相手のホストと事前に暗号の種類や暗号鍵を取り決めて（Security Assosiation）
 SAの交換と交換相手ホストの認証（Internet Key Exchange）をする。
 VPNを実現するための道具として使われる。
キーワードはAHとESP


### IPv6
表記法のルールは、
 * ( 16進数 × 4 ) × 8
 * 「:」で区切られたフィールドが全て0の場合は省略して書く（ただし省略はアドレス中の1箇所だけ）
 * 「/」以降の数値はプレフィックス（ネットワーク部）/インターフェースID（ホスト部）の区切り
 
代表的なアドレスの形は次の通り。

#### ループバックアドレス（::1/128）
IPv4の127.0.0.1に相当

#### グローバルユニキャストアドレス（決まってるの以外）
IPv6ネットワークの中の一意のアドレス。一般的なやつ。

#### リンクローカルユニキャストアドレス（fe80::/10）
ルータを超えない範囲内でのみ有効な、一意のアドレス。

#### ユニークローカルユニキャストアドレス（fc00::/7）
企業LANや自宅LANなどのように端末同士の通信を行う際、

#### インターネット接続が生じない範囲のネットワークでのみ有効な一意のアドレス。
IPv4のプライベートアドレスに相当する。

#### マルチキャストアドレス（ff00::/8）
複数のアドレス宛に同報通信を行うためのアドレス。
IPv4のマルチキャスト、ブロードキャストを兼ねた役割を果たす。


### NAT／NAPT：Network Address Translation

ネットワークアドレス変換。
宛先IPを別のアドレスに変換する技術のこと。
プライベートIPで割り当てたコンピュータに対し、プライベートIPとグローバルIPを変換して
インターネットにアクセス可能にしたりする。
NAPT（Network Address Port Translation）は、アドレスに加えてポート番号まで変換する技術。

### NPS：Network Policy Server

ネットワークポリシーを一元的に構成・管理できるサーバ。
 
### NFV：Network Function Visualization

ネットワーク機器の機能を仮想マシンとして実装する方式のこと。
ルータ、ファイアウォール、ロードバランサなどのコストがかかるハードウェアを、仮想マシンで実行されるソフトウェアとして提供する考え方。


### ONU：Optical Network Unit（光回線の終端装置）

家でインターネットを契約した時に、業者さんがつけてくれるあれ。
光信号とデジタル信号を変換する役割がある。
モデムとは違う。（モデムは光じゃなくてADSLやCATV回線を使っている時だし、アナログーデジタルの変換）
 
### OSPF：Open Shortest Path First

最短パス優先を標準かしたルーティングプロトコル。
各ルータがそれぞれネットワークの地図「リンクステート」を持ち、それを元に最適な経路を計算する。
陸情報には「コスト」と呼ばれる値がつけられ、「コスト」が少ないほど良いリンク。
つまりコストが小さい経路が優先される。


### PBR：Policy Based Routing
管理者が設定した情報に基づいてルーティングを行える技術のこと。
特定の条件（送信元IP、ポートなど）で宛先IPアドレスを変えたい場合などに使用する。
設定はPBRコマンドで行う。

|コマンド|説明|
|match ip adress acl|PBRにおける対象パケットの合致条件に、ACLを使用|
|match length min max|PBRにおける対象パケットの合致条件に、Layer3パケットの長さを使用|
|set ip next-hop address|matchコマンドの合致パケットに、ルーティングとは異なるネクストホップ（次の宛先）を提供|


### PPP：Point-to-Point Protocol

2点間を接続してデータ通信するための通信プロトコル。
電話回線を通じてコンピュータをネットーワクに接続するダイヤルアップ接続でよく使われる。
リンク制御プロトコル(Link Control Protocol：LCP)と
ネットワーク制御プロトコル(Network Control Protocol：NCP)という2つの通信プロトコルを使用する。
認証や圧縮のプロトコルも規定されている？


### PPPoE：PPP over Ethernet

PPPを、イーサネット場で利用できるようにしたもの。


### RARP：Reverse Address Resolution Protocol

ARPがIPアドレスから機器のMACあどれを得るのと逆に、
MACアドレスからIPアドレスを取得するためのプロトコル。
データリンク層に位置する。

### RIP：Routing Infomation Protocol

小規模ネットワークで使用されるルーティングプロトコル。
ホップ数（経由するルータ数）を基準に最適ルートを決定する。
扱えるホップ数の最大数は15で、16台以上の場合は別の方法でルーティングしなければならない。


### SAN：Storage Area Network

ハードディスク装置や磁気テープ装置などのストレージと、サーバなどのコンピュータを
FC（ファイバチャネル）やSCSIプロトコルを用いて接続したストレージネットワーク。
LANとは独立した別のネットワークとして構築される。


### SDN：Software Defined Networking

ネットワークの設定をソフトウェアで動的に制御する技術。
ルータやスイッチなどのネットワーク機器の構成や接続ルートなどを、ソフトウェアの設定で実現する。
ネットワークの設定変更を行う際、ケーブルの抜き差しなど物理的な変更が不要となる。

#### 使用例

異なる複数企業のシステム機器が混在しているデータセンターでは、独立性を保障するために
それぞれの企業で分離しなければならず、機器も別々に管理しなければならない。
しかしSDNがあれば、全てを1つの物理的なネットワークで構成しても
設定を変更することで個別に独立してネットワークとして機能させることができる。


### SHA-256
しゃーにごろ。ハッシュアルゴリズムの代表的なもののひとつ。
ハッシュ関数は主に改ざん検知に使われている。
MD系とSHA系の二つに分けあれるが、MD系（128bit）は衝突性が確認されているためSHAのほうが安全。
SSL/TLSサーバ証明書にも使われている。


### TCP-IP

* IP：Internet Protocol > IPアドレス
* TCP：Transport Control Protocol > ポート番号

ホスト名からIPアドレスを求めることを「正引き」
逆に、IPアドレスからホスト名を求めることを「逆引き」という。（主にDNSサーバの役割）
IPのレイヤーはOSI 7階層モデルでは、ネットワーク層に位置して、
世の中の実際は IP しかないと思って間違いない。
でもTCP、 つまり、トランスポート層はTCP以外にもUDPとかある。
HULFTだと、詳細ホスト情報という管理情報に
ホスト名とポート番号を指定する
このホスト名がIPのレイヤーで、ポート番号がTCPのレイヤー
IPアドレスをみて、ルーターが宛先のホストを決定する。送るのはパケット。
宛先にパケットが届くと、宛先のホストはポート番号を見て、
振り分け先のアプリケーションを決定する。


### TLS:Transport Layer Security

OSI基本参照モデルのトランスポート層において、
通信の暗号化、ディジタル署名を利用した改ざん検出、ノード認証などの機能を提供する
統合セキュアプロトコル。
主にWebブラウザとWebサーバ間でデータを安全にやり取りするための業界標準プロトコル。
webサイト運営元の確認＋暗号化通信が目的。
SSLの後継なのでSSL/TLSと纏められることが多い。
```
SSL/TLSハンドシェイクはTCP/IPのハンドシェイクよりも複雑

1. Client Hello
2. Server Hello
3. (Server Certificate)
4. (Server Key Exchange)
5. (Certificate Request)
6. Server Hello Done
7. (Client Certificate)
8. Client Key Exchange
9. (Certificate Verify)
10. Change Cipher Spec
11. Finished
12. Change Cipher Spec
13. Finished
14. 暗号化通信開始

毎回ハンドシェイクをする穂は大変なので、セッション情報をキャッシュとして保存し、再利用している

```


### VDI：Virtual Desktop Infrastructure

サーバ内にクライアントごとの仮想マシンを用意して、仮想デスクトップを構築する仕組み。
様々なレベルはあるが、基本的にアプリやデータをサーバ上に集約して処理を行わせ、
クライアントは通信や操作に集中する。（シンクライアント的な）
PCとVDIサーバ間はVDIの画面転送プロトコルでやり取りする。


### VLAN：Virtual LAN

仮想的なLANセグメントを作る技術。
たとえば、192.168.1.0/24に A,B,C,D4つのPCが繋がっているとする。
これにVLANを適応して 192.168.10.0/24にA,B、192.168.20.0/24にC,D に分割する。
VLAN適応前はブロードキャスト（同じネットワークのみんなに同じ内容を送りつけること）を行う場合、
192.168.1.xのアドレスが対象なので4つに送られるが
VLAN適応後はブロードキャストの対象を2つずつに分割できる。
つまり各ホストの無駄なCPU処理が削減できる。
あとは会社の部署ごとにファイルサーバ権限をつけたい場合なんかにもVLANを使ったりする。


### VPN：Virtual Private Network

インターネット上に仮想的な専用線を設けて、安全にデータをやりとりする。 

### インターネットVPN

一般的なインターネット回線を利用。 
暗号化することでセキュリティを担保している。お安い。

### IP VPN

大手通信事業者が用意している閉域網を利用。 
閉域網なのでセキュリティが高まる上に、通信速度も安定している。


### Winny

P2P技術を応用したファイル共有ソフト。
著作権関連で事件になり、利用者だけでなく開発者まで逮捕されたことがある。
 

### WPA2：Wi-fi Protected Access 2

無線LANのセキュリティプロトコル（WPA）の脆弱性を改善したもの。
暗号化アルゴリズムがWPAで使用されていた脆弱性のある「RC4」から「AES」に変更され、
解読攻撃に対する耐性が高められている。


### シンクライアント

Thin Client（薄いクライアント）。
処理を全てサーバー側で行わせて、クライアント側は最小限の機能を持つ。
リモートデスクトップみたいなの。


### スイッチ

L2スイッチ：  MACアドレスとスイッチのポートを紐づける（＝イーサネット）
L3スイッチ：  MACアドレスとIPアドレスをスイッチのポートと紐づける（＝ルータ）
 
そもそも、スイッチは通信相手がどのポートにいるかを記憶するもの
L2（データリンク＋物理層）では、スイッチのどのポートにどのPCが繋がっているかをMACアドレスで記憶する
L3（L2＋ネットワーク層）では、VLAN間で通信を行うルーティングができる
L3とルータは似てるけど、
* ルータ  -> WANで使用する機能が揃っているので、WAN接続
* L3スイッチ -> 高速なので、LAN内
という感じで使用されることが多いみたい


### スプリットトンネル
特定通信と通常通信を分離し、指定した特定通信のみトンネルを使用させること。
VPNを利用する場合、VPNを張った先ではVPNトンネルを通って通信しするためインターネットへ接続ができなくなる。
インターネットにアクセスしたい場合はVPNを切る必要がある。
それでは効率が悪いので、特定の通信のみトンネリングさせるのがスプリットトンネルである。
例えば、海外とローカルのウェブサービスに同時にアクセスしたい場合など


### ティアレベル
データセンターにおける信頼性を実現するためのファシリティ基準。
日本データセンター協会（JDCC）が決めた。

#### レベル
数字が大きいほど要求が厳しい。

ティア1
 * エンドユーザの稼働信頼性 99.67％以上
 * 地震や火災などの災害時に、建物として一般レベルの安全性の確保が必要
 * 瞬間的な停電であればサービス提供を継続できる設備がある
 * サーバ室へのアクセスが管理される
 
ティア2
 * エンドユーザの稼働信頼性 99.75％以上
 * 長時間の停電でもサービス提供を継続できる設備がある
 * そのほかの点はティア1と同じ
 
ティア3
 * エンドユーザ位の稼働信頼性 99.98％以上
 * 地震や火災などの災害時に、建物として一般レベルより高いレベルの安全性の確保が必要
 * 停電でなく、メンテナンス時のような一部設備が停止する場合でもサービス提供を継続できる
 * ティア1、2に加えて建物へのアクセスが管理される

ティア4
 * エンドユーザの稼働信頼性 99.99％以上
 * 地震や火災などの災害時に、データ保全の安全性を維持できる高いレベルの災害体制が必要
 * 停電、メンテナンス時だけでなく、機器の故障時などでもサービス提供を継続できる
 * ティア3に加えて敷地やラック内のIT機器へのアクセスが管理される


### バックボーンネットワーク

インターネットなどの大規模ネットワークにおける、事業者間や国家間を結ぶ高速・大容量の回線のこと。
NOC（ネットワークオペレーションセンター）間をデジタル回線で接続して構成している。


### ポート
```
FTP：　20（データ転送）、21（制御）
SSH：　22
Telnet：　23
SMTP：　25
DNS：　53
DHCP：　67（サーバ）、68（クライアント）
HTTP：　80
POP3：　110
NTP：　123
HTTP：　443
```

### ルーティング

ネットワーク上でデータを送信する際に、宛先アドレスの譲歩を元に最適な転送経路を割り出すこと。
IPネットワークの世界では、パケットの中継を行うリーティングの役割が非常に重要。
管理方法は以下の2つに分けられる。
現状、ダイナミックルーティングを使用せずに構築するケースはほとんどない。

#### ダイナミックルーティング

以下のようなルーティングプロトコルを用いて、ルータが経路情報を自動的に学習する手法。
経路情報は動的に更新される。
 * RIP（Routing Infomation Protocol）：ディスタンスベクタ型（最短のホップ数割り出し）
 * OSPF（Open Shortest Path First）：リンクステート型（どのルータとどのルータがつながっているか？）
 * BGP（Border Gateway Protocol）：パスベクトル型（？？）
 
メリットは、
 * 管理の手間が省ける
 * 利用不能でない適切な経路を選択させることが可能
 
デメリットは、
 * 設定を誤ると広範囲の通信不能が発生してしまう可能性がある
 * 悪のケースとして、経路ループが起きた場合に負荷がかかりネットワークがダウンする

#### スタティック・ルーティング

経路情報を各ルータ内に手動で設定する方法。経路情報はルーティングテーブルから消えることはない。

メリットは、
 * 安定したネットワークの供給が可能
 * 情報交換のためのCPU処理やトラフィックが発生しない
 
デメリットは、
 * 宛先ネットワークが実在しなくなった場合にもこの情報に基づく転送が行われてしまう
 * 経路情報数が増えると、管理が大変


